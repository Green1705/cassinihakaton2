<!DOCTYPE html>
<html>
<head>
  <title>Track Another User</title>
  <style>
    #map { height: 100vh; width: 100%; }
  </style>
</head>
<body>

<h2 style="text-align:center;">Live Tracking Map</h2>
<div id="map"></div>

<!-- Firebase + Google Maps -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwmfAmEiF-BFOaK0XwlV6HMrnzW78zUbw&callback=initMap" async defer></script>

<script>
  // Replace with your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyBsL_N24_G_vIdaJr5GTPQMzpTtD3Woetg",
    authDomain: "cassinihakaton.firebaseapp.com",
    databaseURL: "https://cassinihakaton-default-rtdb.europe-west1.firebasedatabase.app/",
    projectId: "cassinihakaton",
    storageBucket: "cassinihakaton.firebasestorage.app",
    messagingSenderId: "262843851908",
    appId: "1:262843851908:web:6c4110bc00fb5f44ef8ed1",
    measurementId: "G-S2K08DVGBM"
  };


  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let map, myMarker, otherMarker;

  function initMap() {
    const defaultLocation = { lat: 50.1109, lng: 8.6821 };
    map = new google.maps.Map(document.getElementById("map"), {
      center: defaultLocation,
      zoom: 13,
    });

    myMarker = new google.maps.Marker({ map, label: "Me" });
    otherMarker = new google.maps.Marker({ map, label: "Other" });

    // Start location tracking
    if (navigator.geolocation) {
      navigator.geolocation.watchPosition((position) => {
        const myPos = {
          lat: position.coords.latitude,
          lng: position.coords.longitude,
        };

        myMarker.setPosition(myPos);
        map.setCenter(myPos);

        // Send to Firebase
        db.ref("users/user1").set(myPos);
      });
    }

    // Listen for other user's location
    db.ref("users/user2").on("value", (snapshot) => {
      const otherPos = snapshot.val();
      if (otherPos) {
        otherMarker.setPosition(otherPos);
      }
    });
  }
</script>
</body>
</html>
